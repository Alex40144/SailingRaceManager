generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider     = "mysql"
  url          = env("DATABASE_URL")
  relationMode = "prisma"
}

model Users {
  name     String
  id       String @id @unique @default(uuid())
  email    String @unique
  password String
  settings Json
  club     Clubs  @relation(fields: [clubId], references: [id])
  clubId   String
  permLvl  Int

  @@index([clubId])
}

model Boats {
  id      String   @id @unique @default(uuid())
  name    String
  crew    Int
  py      Int
  club    Clubs    @relation(fields: [clubId], references: [id])
  clubId  String
  results Result[]

  @@index([clubId])
}

model Clubs {
  id       String   @id @unique @default(uuid())
  name     String   @unique
  settings Json
  series   Series[]
  boats    Boats[]
  users    Users[]
}

model Series {
  id       String @id @unique @default(uuid())
  name     String @unique
  club     Clubs  @relation(fields: [clubId], references: [id])
  clubId   String
  settings Json
  races    Race[]

  @@index([clubId])
}

model Race {
  id       String   @id @unique @default(uuid())
  number   Int
  Time     String
  OOD      String
  AOD      String
  SO       String
  ASO      String
  results  Result[]
  Type     String
  series   Series   @relation(fields: [seriesId], references: [id])
  seriesId String

  @@index([seriesId])
}

model Result {
  id            String  @id @unique @default(uuid())
  race          Race    @relation(fields: [raceId], references: [id])
  raceId        String
  Helm          String
  Crew          String
  boat          Boats?  @relation(fields: [boatId], references: [id])
  boatId        String?
  SailNumber    Int
  Time          String
  CorrectedTime Float
  Laps          Int
  Position      Int

  @@index([raceId])
  @@index([boatId])
}
